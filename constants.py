import torch
import os

bless_str = ("                         _oo0oo_\n"
             "                        o8888888o\n"
             "                        88\" . \"88\n"
             "                        (| -_- |)\n"
             "                        0\  =  /0\n"
             "                      ___/`---'\___\n"
             "                    .' \\|     |// '.\n"
             "                   / \\|||  :  |||// \ \n"
             "                  / _||||| -:- |||||- \ \n"
             "                 |   | \\\  - /// |   |\n"
             "                 | \_|  ''\---/''  |_/ |\n"
             "                 \  .-\__  '-'  ___/-. /\n"
             "               ___'. .'  /--.--\  `. .'___\n"
             "            .\"\" '<  `.___\_<|>_/___.' >' \"\".\n"
             "           | | :  `- \`.;`\ _ /`;.`/ - ` : | |\n"
             "           \  \ `_.   \_ __\ /__ _/   .-` /  /\n"
             "       =====`-.____`.___ \_____/___.-`___.-'=====\n"
             "                         `=---='\n"
             "       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n"
             "                 BLESS ME WITH NO BUGS\n"
             )
print(bless_str)
avg_batch_size = 128
perframe_batch_size = 2048
rnn_batch_size = 128
conv1d_batch_size = 128
gcn_batch_size = 128
stgcn_batch_size = 32
learning_rate = 1e-3

if torch.cuda.is_available():
    print('Using CUDA for training')
    device = torch.device("cuda:0")
    os.environ['CUDA_LAUNCH_BLOCKING'] = "1"
    os.environ['PYTORCH_CUDA_ALLOC_CONF'] = 'expandable_segments:True'
    # device = torch.device('cpu')
elif torch.backends.mps.is_available():
    print('Using MPS for training')
    device = torch.device('mps')
else:
    print('Using CPU for training')
    device = torch.device('cpu')
dtype = torch.float32
intention_class = ['interacting', 'interested', 'not_interested']
attitude_classes = ['positive', 'negative', 'no_interacting']
action_classes = ['hand_shake', 'hug', 'pet', 'wave', 'punch', 'throw', 'point-converse', 'gaze', 'leave',
                  'no_response']

coco_body_point_num = 23
halpe_body_point_num = 26
head_point_num = 68
hands_point_num = 42
valset_rate = 0.1
testset_rate = 0.4
video_fps = 30

coco_body_l_pair = [[0, 1], [0, 2], [1, 3], [2, 4],  # Head
                    [5, 7], [7, 9], [6, 8], [8, 10],  # Body
                    [5, 6], [11, 12], [5, 11], [6, 12],
                    [11, 13], [12, 14], [13, 15], [14, 16],
                    [15, 17], [15, 18], [15, 19], [16, 20], [16, 21], [16, 22]]
coco_head_l_pair = [[23, 24], [24, 25], [25, 26], [26, 27], [27, 28], [28, 29], [29, 30], [30, 31], [31, 32],
                    [32, 33], [33, 34], [34, 35],
                    [35, 36], [36, 37], [37, 38], [38, 39], [40, 41], [41, 42], [42, 43], [43, 44], [45, 46],
                    [46, 47], [47, 48], [48, 49],
                    [50, 51], [51, 52], [52, 53], [54, 55], [55, 56], [56, 57], [57, 58], [59, 60], [60, 61],
                    [61, 62], [62, 63], [63, 64],
                    [65, 66], [66, 67], [67, 68], [68, 69], [69, 70], [71, 72], [72, 73], [73, 74], [74, 75],
                    [75, 76], [76, 77], [77, 78],
                    [78, 79], [79, 80], [80, 81], [81, 82], [82, 83], [83, 84], [84, 85], [85, 86], [86, 87],
                    [87, 88], [88, 89], [89, 90]]
coco_hand_l_pair = [[91, 92], [92, 93], [93, 94], [94, 95], [91, 96], [96, 97], [97, 98], [98, 99], [91, 100],
                    [100, 101], [101, 102],
                    [102, 103], [91, 104], [104, 105], [105, 106], [106, 107], [91, 108], [108, 109], [109, 110],
                    [110, 111], [112, 113],
                    [113, 114], [114, 115], [115, 116], [112, 117], [117, 118], [118, 119], [119, 120], [112, 121],
                    [121, 122], [122, 123],
                    [123, 124], [112, 125], [125, 126], [126, 127], [127, 128], [112, 129], [129, 130], [130, 131],
                    [131, 132]]
halpe_body_l_pair = [[0, 1], [0, 2], [1, 3], [2, 4],  # Head
                     [5, 18], [6, 18], [5, 7], [7, 9], [6, 8], [8, 10],  # Body
                     [17, 18], [18, 19], [19, 11], [19, 12],
                     [11, 13], [12, 14], [13, 15], [14, 16],
                     [20, 24], [21, 25], [23, 25], [22, 24], [15, 24], [16, 25],  # Foot
                     ]
halpe_head_l_pair = [[26, 27], [27, 28], [28, 29], [29, 30], [30, 31], [31, 32], [32, 33], [33, 34], [34, 35],
                     [35, 36], [36, 37], [37, 38],  # Face
                     [38, 39], [39, 40], [40, 41], [41, 42], [43, 44], [44, 45], [45, 46], [46, 47], [48, 49],
                     [49, 50], [50, 51], [51, 52],  # Face
                     [53, 54], [54, 55], [55, 56], [57, 58], [58, 59], [59, 60], [60, 61], [62, 63], [63, 64],
                     [64, 65], [65, 66], [66, 67],  # Face
                     [68, 69], [69, 70], [70, 71], [71, 72], [72, 73], [74, 75], [75, 76], [76, 77], [77, 78],
                     [78, 79], [79, 80], [80, 81],  # Face
                     [81, 82], [82, 83], [83, 84], [84, 85], [85, 86], [86, 87], [87, 88], [88, 89], [89, 90],
                     [90, 91], [91, 92], [92, 93]  # Face
                     ]
halpe_hand_l_pair = [[94, 95], [95, 96], [96, 97], [97, 98], [94, 99], [99, 100], [100, 101], [101, 102], [94, 103],
                     [103, 104], [104, 105],  # LeftHand
                     [105, 106], [94, 107], [107, 108], [108, 109], [109, 110], [94, 111], [111, 112], [112, 113],
                     [113, 114],  # LeftHand
                     [115, 116], [116, 117], [117, 118], [118, 119], [115, 120], [120, 121], [121, 122], [122, 123],
                     [115, 124], [124, 125],  # RightHand
                     [125, 126], [126, 127], [115, 128], [128, 129], [129, 130], [130, 131], [115, 132], [132, 133],
                     [133, 134], [134, 135]  # RightHand
                     ]
